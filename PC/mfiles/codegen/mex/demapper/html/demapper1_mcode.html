<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">LLR</span> =  demapper(<span class="var type1" id="S3T2U6">X</span>,<span class="var type1" id="S4T3U7">L</span>,<span class="var type1" id="S5T4U8">snrdB</span>,<span class="var type1" id="S6T5U9">y</span>,<span class="var type1" id="S7T6U10">Ik1</span>,<span class="var type1" id="S8T6U11">Ik0</span>,<span class="var type1" id="S9T4U12">flag_demapper</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% This function computes L-values for a given constellation X, labeling</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% L, snr based on the channel observations Y.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% X is M times N, where N is the number of dimensions</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% L is M times m, where M=2^m is the number of constellation points</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% y is Ns times N.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% The function returns a matrix of m times Ns LLRs</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="comment">% flag_demapper==0 Sum-Exp</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="comment">% flag_demapper==1 Max-Log</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T4:U9"><span class="var type1" id="S10T4U15">snr</span> = <span class="mxinfo " id="T4:U11"><span class="potentialdiff PD1"><span class="mxinfo " id="T4:U12">10</span>^(<span class="mxinfo " id="T4:U13"><span class="var type1" id="S5T4U20">snrdB</span>/<span class="mxinfo " id="T4:U15">10</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T4:U16"><span class="var type1" id="S11T4U24">N0</span>  = <span class="mxinfo " id="T4:U18"><span class="mxinfo " id="T4:U19">1</span>/<span class="var type1" id="S10T4U27">snr</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T4:U21"><span class="var type1" id="S12T4U30">M</span>   = <span class="mxinfo " id="T4:U23">size(<span class="var type1" id="S3T2U33">X</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T4:U25"><span class="var type1" id="S14T4U37">m</span>   = <span class="mxinfo " id="T4:U27">size(<span class="var type1" id="S4T3U40">L</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T4:U29"><span class="var type1" id="S15T4U44">Ns</span>  = <span class="mxinfo " id="T4:U31">size(<span class="var type1" id="S6T5U47">y</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T1:U33"><span class="var type1" id="S2T1U51">LLR</span> = <span class="mxinfo " id="T1:U35">zeros(<span class="var type1" id="S14T4U54">m</span>,<span class="var type1" id="S15T4U55">Ns</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S17T4U58">k</span>=<span class="mxinfo " id="T4:U39">1</span>:<span class="var type1" id="S14T4U61">m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S18T4U64">l</span>=<span class="mxinfo " id="T4:U42">1</span>:<span class="var type1" id="S15T4U67">Ns</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T7:U44"><span class="var type1" id="S9T4U71">flag_demapper</span>==<span class="mxinfo " id="T4:U46">0</span></span> <span class="comment">% Sum-Exp</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">            <span class="mxinfo " id="T4:U47"><span class="mxinfo " id="T4:U48"><span class="var type1" id="S2T1U76">LLR</span>(<span class="mxinfo " id="T4:U50"><span class="var type1" id="S17T4U77"><span class="potentialdiff PD2">k</span></span></span>,<span class="mxinfo " id="T4:U51"><span class="var type1" id="S18T4U78"><span class="potentialdiff PD2">l</span></span></span>)</span> =  <span class="mxinfo " id="T4:U52"><span class="mxinfo " id="T4:U53"><span class="potentialdiff PD1">log(<span class="mxinfo " id="T4:U54"><span class="potentialdiff PD5">sum(<span class="mxinfo " id="T8:U55">exp(<span class="mxinfo " id="T8:U56">-<span class="mxinfo " id="T8:U57">sum(<span class="mxinfo " id="T9:U58"><span class="mxinfo " id="T9:U59"><span class="potentialdiff PD1">(<span class="mxinfo " id="T9:U60"><span class="potentialdiff PD3"><span class="mxinfo " id="T9:U61">repmat(<span class="mxinfo " id="T10:U62"><span class="var type1" id="S6T5U96">y</span>(<span class="var type1" id="S18T4U97">l</span>,<span class="mxinfo " id="T11:U65">:</span>)</span>,<span class="mxinfo " id="T4:U66"><span class="var type1" id="S12T4U100">M</span>/<span class="mxinfo " id="T4:U68">2</span></span>,1)</span>-<span class="mxinfo " id="T9:U69"><span class="var type1" id="S3T2U104">X</span>(<span class="mxinfo " id="T8:U71"><span class="potentialdiff PD4"><span class="var type1" id="S7T6U106">Ik1</span>(<span class="mxinfo " id="T12:U73">:</span>,<span class="var type1" id="S17T4U108">k</span>)</span></span>,<span class="mxinfo " id="T11:U75">:</span>)</span></span></span>).^2</span></span>/<span class="var type1" id="S11T4U111">N0</span></span>,2)</span></span>)</span>)</span></span>)</span></span>-<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">                        <span class="mxinfo " id="T4:U77"><span class="potentialdiff PD1">log(<span class="mxinfo " id="T4:U78"><span class="potentialdiff PD5">sum(<span class="mxinfo " id="T8:U79">exp(<span class="mxinfo " id="T8:U80">-<span class="mxinfo " id="T8:U81">sum(<span class="mxinfo " id="T9:U82"><span class="mxinfo " id="T9:U83"><span class="potentialdiff PD1">(<span class="mxinfo " id="T9:U84"><span class="potentialdiff PD3"><span class="mxinfo " id="T9:U85">repmat(<span class="mxinfo " id="T10:U86"><span class="var type1" id="S6T5U129">y</span>(<span class="var type1" id="S18T4U130">l</span>,<span class="mxinfo " id="T11:U89">:</span>)</span>,<span class="mxinfo " id="T4:U90"><span class="var type1" id="S12T4U133">M</span>/<span class="mxinfo " id="T4:U92">2</span></span>,1)</span>-<span class="mxinfo " id="T9:U93"><span class="var type1" id="S3T2U137">X</span>(<span class="mxinfo " id="T8:U95"><span class="potentialdiff PD4"><span class="var type1" id="S8T6U139">Ik0</span>(<span class="mxinfo " id="T12:U97">:</span>,<span class="var type1" id="S17T4U141">k</span>)</span></span>,<span class="mxinfo " id="T11:U99">:</span>)</span></span></span>).^2</span></span>/<span class="var type1" id="S11T4U144">N0</span></span>,2)</span></span>)</span>)</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">        <span class="keyword">elseif</span> <span class="mxinfo " id="T7:U101"><span class="var type1" id="S9T4U148">flag_demapper</span>==<span class="mxinfo " id="T4:U103">1</span></span> <span class="comment">%Max-log</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">            <span class="mxinfo " id="T4:U104"><span class="mxinfo " id="T4:U105"><span class="var type1" id="S2T1U153">LLR</span>(<span class="mxinfo " id="T4:U107"><span class="var type1" id="S17T4U154"><span class="potentialdiff PD2">k</span></span></span>,<span class="mxinfo " id="T4:U108"><span class="var type1" id="S18T4U155"><span class="potentialdiff PD2">l</span></span></span>)</span> =  <span class="mxinfo " id="T4:U109"><span class="mxinfo " id="T4:U110"><span class="potentialdiff PD1">log(<span class="mxinfo " id="T4:U111"><span class="potentialdiff PD5"><span class="potentialdiff PD6">max(<span class="mxinfo " id="T8:U112">exp(<span class="mxinfo " id="T8:U113">-<span class="mxinfo " id="T8:U114">sum(<span class="mxinfo " id="T9:U115"><span class="mxinfo " id="T9:U116"><span class="potentialdiff PD1">(<span class="mxinfo " id="T9:U117"><span class="potentialdiff PD3"><span class="mxinfo " id="T9:U118">repmat(<span class="mxinfo " id="T10:U119"><span class="var type1" id="S6T5U173">y</span>(<span class="var type1" id="S18T4U174">l</span>,<span class="mxinfo " id="T11:U122">:</span>)</span>,<span class="mxinfo " id="T4:U123"><span class="var type1" id="S12T4U177">M</span>/<span class="mxinfo " id="T4:U125">2</span></span>,1)</span>-<span class="mxinfo " id="T9:U126"><span class="var type1" id="S3T2U181">X</span>(<span class="mxinfo " id="T8:U128"><span class="potentialdiff PD4"><span class="var type1" id="S7T6U183">Ik1</span>(<span class="mxinfo " id="T12:U130">:</span>,<span class="var type1" id="S17T4U185">k</span>)</span></span>,<span class="mxinfo " id="T11:U132">:</span>)</span></span></span>).^2</span></span>/<span class="var type1" id="S11T4U188">N0</span></span>,2)</span></span>)</span>)</span></span></span>)</span></span>-<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">                        <span class="mxinfo " id="T4:U134"><span class="potentialdiff PD1">log(<span class="mxinfo " id="T4:U135"><span class="potentialdiff PD5"><span class="potentialdiff PD6">max(<span class="mxinfo " id="T8:U136">exp(<span class="mxinfo " id="T8:U137">-<span class="mxinfo " id="T8:U138">sum(<span class="mxinfo " id="T9:U139"><span class="mxinfo " id="T9:U140"><span class="potentialdiff PD1">(<span class="mxinfo " id="T9:U141"><span class="potentialdiff PD3"><span class="mxinfo " id="T9:U142">repmat(<span class="mxinfo " id="T10:U143"><span class="var type1" id="S6T5U206">y</span>(<span class="var type1" id="S18T4U207">l</span>,<span class="mxinfo " id="T11:U146">:</span>)</span>,<span class="mxinfo " id="T4:U147"><span class="var type1" id="S12T4U210">M</span>/<span class="mxinfo " id="T4:U149">2</span></span>,1)</span>-<span class="mxinfo " id="T9:U150"><span class="var type1" id="S3T2U214">X</span>(<span class="mxinfo " id="T8:U152"><span class="potentialdiff PD4"><span class="var type1" id="S8T6U216">Ik0</span>(<span class="mxinfo " id="T12:U154">:</span>,<span class="var type1" id="S17T4U218">k</span>)</span></span>,<span class="mxinfo " id="T11:U156">:</span>)</span></span></span>).^2</span></span>/<span class="var type1" id="S11T4U221">N0</span></span>,2)</span></span>)</span>)</span></span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
</body>
</html>
